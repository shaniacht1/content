category: Network Security
commonfields:
  id: Symantec Management Center
  version: -1
configuration:
- defaultvalue: ""
  display: Server URL (e.g. https://192.168.0.1:8082)
  name: url
  required: true
  type: 0
- defaultvalue: ""
  display: Username
  name: credentials
  required: true
  type: 9
- defaultvalue: ""
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ""
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Symantec Management Center provides a unified management environment
  for the Symantec Security Platform portfolio of products.
display: Symantec Management Center
image: data:image/png;base64,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
name: Symantec Management Center
script:
  commands:
  - arguments:
    - description: 'Filter the query filter parameter by the OS build number, for
        example: "GT 227900". '
      isArray: true
      name: build
    - description: 'Filter the query filter parameter by description, for example:
        "CONTAINS" desc".'
      name: description
    - description: 'Filter the query filter parameter by model, for example: "EQ VSWG-SE".'
      name: model
    - description: 'Filter the query filter parameter by name, for example: "STARTSWITH
        CAS". '
      name: name
    - description: 'Filter the query filter parameter by OS version, for example:
        "LT 2.3".'
      name: os_version
    - description: 'Filter the query filter parameter by platform, for example: "CONTAINS
        CAS". '
      name: platform
    - description: 'Filter the query filter parameter by device type, for example:
        "cas". '
      name: type
    - defaultValue: "10"
      description: Maximum number of results to return.
      name: limit
    description: Lists all devices in Symantec MC.
    name: symantec-mc-list-devices
    outputs:
    - contextPath: SymantecMC.Device.UUID
      description: Device UUID.
      type: String
    - contextPath: SymantecMC.Device.Name
      description: Device name.
      type: String
    - contextPath: SymantecMC.Device.LastChanged
      description: Device last changed date.
      type: Date
    - contextPath: SymantecMC.Device.Type
      description: Device type.
      type: String
    - contextPath: SymantecMC.Device.Host
      description: Device host address.
      type: String
  - arguments:
    - default: true
      description: Device UUID. Run the symantec-mc-list-devices command to get the
        UUID.
      name: uuid
      required: true
    description: Gets device information from Symantec MC.
    name: symantec-mc-get-device
    outputs:
    - contextPath: SymantecMC.Device.UUID
      description: Device UUID.
      type: String
    - contextPath: SymantecMC.Device.Name
      description: Device name.
      type: String
    - contextPath: SymantecMC.Device.LastChanged
      description: Device last changed date.
      type: String
    - contextPath: SymantecMC.Device.LastChangedBy
      description: User that last changed the device.
      type: String
    - contextPath: SymantecMC.Device.Description
      description: Device description.
      type: String
    - contextPath: SymantecMC.Device.Model
      description: Device model.
      type: String
    - contextPath: SymantecMC.Device..Platform
      description: Device platform
      type: String
    - contextPath: SymantecMC.Device.Type
      description: Device type.
      type: String
    - contextPath: SymantecMC.Device.OSVersion
      description: Device OS version.
      type: String
    - contextPath: SymantecMC.Device.Build
      description: Device build number.
      type: Number
    - contextPath: SymantecMC.Device.SerialNumber
      description: Device serial number.
      type: Number
    - contextPath: SymantecMC.Device.Host
      description: Device host address.
      type: String
    - contextPath: SymantecMC.Device.ManagementStatus
      description: Device management status.
      type: String
    - contextPath: SymantecMC.Device.DeploymentStatus
      description: Device deployment status.
      type: String
  - arguments:
    - default: true
      description: Device UUID. Run the symantec-mc-list-devices command to get the
        UUID.
      name: uuid
      required: true
    description: Gets health information for a device.
    name: symantec-mc-get-device-health
    outputs:
    - contextPath: SymantecMC.Device.UUID
      description: Device UUID.
      type: String
    - contextPath: SymantecMC.Device.Name
      description: Device name.
      type: String
    - contextPath: SymantecMC.Device.Health.Category
      description: Device health category.
      type: String
    - contextPath: SymantecMC.Device.Health.Name
      description: Device health name.
      type: String
    - contextPath: SymantecMC.Device.Health.State
      description: Device health state.
      type: String
    - contextPath: SymantecMC.Device.Health.Message
      description: Device health message.
      type: String
    - contextPath: SymantecMC.Device.Health.Status
      description: Device health status.
      type: String
  - arguments:
    - default: true
      description: Device UUID. Run the symantec-mc-list-devices command to get the
        UUID.
      name: uuid
      required: true
    description: Gets license information for a device in Symantec MC.
    name: symantec-mc-get-device-license
    outputs:
    - contextPath: SymantecMC.Device.UUID
      description: Device UUID.
      type: String
    - contextPath: SymantecMC.Device.Name
      description: Device name.
      type: String
    - contextPath: SymantecMC.Device.Type
      description: Device type.
      type: String
    - contextPath: SymantecMC.Device.LicenseStatus
      description: Device license status.
      type: String
    - contextPath: SymantecMC.Device.LicenseComponent.Name
      description: Device license component name.
      type: String
    - contextPath: SymantecMC.Device.LicenseComponent.ActivationDate
      description: Device license component activation date.
      type: Date
    - contextPath: SymantecMC.Device.LicenseComponent.ExpirationDate
      description: Device license component expiration date
      type: Date
    - contextPath: SymantecMC.Device.LicenseComponent.Validity
      description: Device license component validity.
      type: String
  - arguments:
    - default: true
      description: Device UUID. Run the symantec-mc-list-devices command to get the
        UUID.
      name: uuid
      required: true
    description: Gets the status of a device.
    name: symantec-mc-get-device-status
    outputs:
    - contextPath: SymantecMC.Device.UUID
      description: Device UUID.
      type: String
    - contextPath: SymantecMC.Device.Name
      description: Device name.
      type: String
    - contextPath: SymantecMC.Device.CheckDate
      description: Device check date.
      type: Date
    - contextPath: SymantecMC.Device.StartDate
      description: Device start date.
      type: Date
    - contextPath: SymantecMC.Device.MonitorState
      description: Device monitor state.
      type: String
    - contextPath: SymantecMC.Device.Warnings
      description: Device warning count.
      type: Number
    - contextPath: SymantecMC.Device.Errors
      description: Device error count.
      type: Number
  - arguments:
    - description: Filter the query filter parameter by content type of policy, e.g.,
        "ENDSWITH URL"
      name: content_type
    - description: 'Filter the query filter parameter by description, for example:
        "CONTAINS desc."'
      name: description
    - description: 'Filter the query filter parameter by name, for example: "STARTSWITH
        my_list". '
      name: name
    - description: 'Filter the query filter parameter by referenceId, for example:
        "EQ my_list". '
      name: reference_id
    - auto: PREDEFINED
      description: Parameter to filter, based on whether the policy is shared or not
        shared.
      name: shared
      predefined:
      - "true"
      - "false"
    - description: Filter the query filter parameter by tenant, e.g., "EQ TENANT_EXTERNAL_ID"
      name: tenant
    - defaultValue: "10"
      description: Limit the number of results returned
      name: limit
    description: List policies in Symantec MC.
    name: symantec-mc-list-policies
    outputs:
    - contextPath: SymantecMC.Policy.UUID
      description: Policy UUID.
      type: String
    - contextPath: SymantecMC.Policy.Name
      description: Policy name.
      type: String
    - contextPath: SymantecMC.Policy.ContentType
      description: Policy content type.
      type: String
    - contextPath: SymantecMC.Policy.Author
      description: Policy author.
      type: String
    - contextPath: SymantecMC.Policy.Shared
      description: Policy shared.
      type: Boolean
    - contextPath: SymantecMC.Policy.ReferenceID
      description: Policy reference ID
      type: String
    - contextPath: SymantecMC.Policy.Tenant
      description: Policy tenant.
      type: String
    - contextPath: SymantecMC.ReplaceVariables
      description: Policy replace variables.
      type: Boolean
  - arguments:
    - default: true
      description: Device UUID. Run the symantec-mc-list-devices command to get the
        UUID.
      name: uuid
    - description: The policy name
      name: name
    description: Gets information for a policy.
    name: symantec-mc-get-policy
    outputs:
    - contextPath: SymantecMC.Policy.Name
      description: Policy name.
      type: String
    - contextPath: SymantecMC.Policy.SchemaVersion
      description: Policy content schema version.
      type: Number
    - contextPath: SymantecMC.Policy.RevisionInfo.Number
      description: Policy content revision number.
      type: Number
    - contextPath: SymantecMC.Policy.RevisionInfo.Description
      description: Policy content revision description.
      type: String
    - contextPath: SymantecMC.Policy.RevisionInfo.Author
      description: Policy content revision author.
      type: String
    - contextPath: SymantecMC.Policy.RevisionInfo.Date
      description: Policy content revision date.
      type: Date
    - contextPath: SymantecMC.Policy.IP.Address
      description: Policy IP address.
      type: String
    - contextPath: SymantecMC.Policy.IP.Description
      description: Policy IP description.
      type: String
    - contextPath: SymantecMC.Policy.IP.Enabled
      description: Policy IP enabled.
      type: Boolean
    - contextPath: SymantecMC.Policy.URL.Address
      description: Policy URL address.
      type: String
    - contextPath: SymantecMC.Policy.URL.Description
      description: Policy URL description.
      type: String
    - contextPath: SymantecMC.Policy.URL.Enabled
      description: Policy URL enabled.
      type: Boolean
    - contextPath: SymantecMC.Policy.Category.Name
      description: Policy category name.
      type: String
    - contextPath: SymantecMC.Policy.UUID
      description: Policy UUID.
      type: String
    - contextPath: SymantecMC.Policy.Description
      description: Policy Description.
      type: String
    - contextPath: SymantecMC.Policy.ReferenceID
      description: Policy reference ID.
      type: String
  - arguments:
    - description: Policy name.
      name: name
      required: true
    - auto: PREDEFINED
      description: Policy content type.
      name: content_type
      predefined:
      - URL_LIST
      - IP_LIST
      - CATEGORY_LIST
      required: true
    - description: Policy description.
      name: description
    - description: Policy reference ID.
      name: reference_id
    - description: UUID of the tenant associated with this policy. Run the symantec-mc-list-tenants
        command to get the tenant UUID.
      name: tenant
    - auto: PREDEFINED
      defaultValue: "true"
      description: Share policy
      name: shared
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: Replace variables supported
      name: replace_variables
      predefined:
      - "true"
      - "false"
    description: Creates a policy in Symantec MC.
    name: symantec-mc-create-policy
    outputs:
    - contextPath: SymantecMC.Policy.UUID
      description: Policy UUID.
      type: String
    - contextPath: SymantecMC.Policy.Name
      description: Policy name.
      type: String
    - contextPath: SymantecMC.Policy.ContentType
      description: Policy content type.
      type: String
    - contextPath: SymantecMC.Policy.Author
      description: Policy author.
      type: String
  - arguments:
    - default: true
      description: Policy UUID. Run the symantec-mc-list-policies command to get the
        UUID.
      name: uuid
      required: true
    - description: New name of the policy.
      name: name
    - description: New description of the policy.
      name: description
    - description: New reference ID of the policy.
      name: reference_id
    - auto: PREDEFINED
      description: Replace variables in the policy.
      name: replace_variables
      predefined:
      - "true"
      - "false"
    description: Updates the metadata for a policy in Symantec MC.
    name: symantec-mc-update-policy
    outputs:
    - contextPath: SymantecMC.Policy.UUID
      description: Policy UUID.
      type: String
    - contextPath: SymantecMC.Policy.Name
      description: Policy name.
      type: String
  - arguments:
    - default: true
      description: Policy UUID. Run the symantec-mc-list-policies command to get the
        UUID.
      name: uuid
      required: true
    - auto: PREDEFINED
      defaultValue: "false"
      description: Set to "true" to force the policy object to be removed even if
        it is referenced by another policy.
      name: force
      predefined:
      - "true"
      - "false"
    description: Deletes a policy in Symantec MC.
    execution: true
    name: symantec-mc-delete-policy
  - arguments:
    - defaultValue: "10"
      description: Maximum number of results to return.
      name: limit
    description: List tenants in Symantec MC.
    name: symantec-mc-list-tenants
    outputs:
    - contextPath: SymantecMC.Tenant.UUID
      description: Tenant UUID.
      type: String
    - contextPath: SymantecMC.Tenant.Name
      description: Tenant name.
      type: String
    - contextPath: SymantecMC.Tenant.ExternalID
      description: Tenant external ID.
      type: String
    - contextPath: SymantecMC.Tenant.Description
      description: Tenant description.
      type: String
    - contextPath: SymantecMC.Tenant.System
      description: Whether the system is a tenant.
      type: Boolean
  - arguments:
    - description: Policy UUID. Run the symantec-mc-list-policies command to get the
        UUID.
      name: uuid
    - description: The policy name to add content to.
      name: name
    - auto: PREDEFINED
      description: Policy content type
      name: content_type
      predefined:
      - URL_LIST
      - IP_LIST
      - CATEGORY_LIST
      required: true
    - description: Description of the policy change.
      name: change_description
      required: true
    - description: The version of the schema for this content. This value will correspond
        to the format of the content. Run the symantec-mc-get-policy command to get
        the schema vesion.
      name: schema_version
    - description: 'CSV list of IP addresses to add, for example: "1.2.3.4, 8.8.8.8".'
      isArray: true
      name: ip
    - description: 'CSV list of URLs to add, for example: "www.google.com, www.github.com".'
      isArray: true
      name: url
    - description: 'CSV list of category names to add, for example: "Job Search/Careers,
        Content Servers".'
      isArray: true
      name: category
    - auto: PREDEFINED
      defaultValue: "false"
      description: Relevant for URL and IP.
      name: enabled
      predefined:
      - "true"
      - "false"
    - description: Content description.
      name: description
    description: Adds content to a policy in Symantec MC. Can be IPs, URLs, or category
      names.
    name: symantec-mc-add-policy-content
  - arguments:
    - description: Policy UUID. Run the symantec-mc-list-policies command to get the
        UUID.
      name: uuid
    - description: The policy name to add content to.
      name: name
    - auto: PREDEFINED
      description: Policy content type.
      name: content_type
      predefined:
      - URL_LIST
      - IP_LIST
      - CATEGORY_LIST
      required: true
    - description: Description of the policy change.
      name: change_description
      required: true
    - description: The version of the schema for this content. This value will correspond
        to the format of the content. Run the symantec-mc-get-policy command to get
        the schema version.
      name: schema_version
    - description: 'CSV list of IP addresses to delete, for example: "1.2.3.4, 8.8.8.8".'
      isArray: true
      name: ip
    - description: 'CSV list of URLs to delete, for example: "www.google.com, www.github.com".'
      isArray: true
      name: url
    - description: 'CSV list of category names to delete, for example: "Job Search/Careers,
        Content Servers".'
      isArray: true
      name: category
    description: Deletes content from a policy in Symantec MC.
    name: symantec-mc-delete-policy-content
  dockerimage: demisto/python3:3.7.3.221
  runonce: false
  script: |2-




    ''' IMPORTS '''

    import json
    import requests
    from distutils.util import strtobool

    # Disable insecure warnings
    requests.packages.urllib3.disable_warnings()

    ''' GLOBALS/PARAMS '''

    USERNAME = demisto.params().get('credentials').get('identifier')
    PASSWORD = demisto.params().get('credentials').get('password')
    SERVER = (demisto.params()['url'][:-1]
              if (demisto.params()['url'] and demisto.params()['url'].endswith('/')) else demisto.params()['url'])
    BASE_URL = SERVER + '/api/'
    USE_SSL = not demisto.params().get('insecure', False)
    HEADERS = {
        'Content-Type': 'application/json',
        'Accept': 'application/json'
    }
    URL_LIST_TYPE = 'URL_LIST'
    IP_LIST_TYPE = 'IP_LIST'
    CATEGORY_LIST_TYPE = 'CATEGORY_LIST'

    ''' HELPER FUNCTIONS '''


    def http_request(method, path, params=None, data=None):
        """
        Sends an HTTP request using the provided arguments
        :param method: HTTP method
        :param path: URL path
        :param params: URL query params
        :param data: Request body
        :return: JSON response (or the response itself if not serializable)
        """
        params = params if params is not None else {}
        data = data if data is not None else {}
        res = None

        try:
            res = requests.request(
                method,
                BASE_URL + path,
                auth=(USERNAME, PASSWORD),
                verify=USE_SSL,
                params=params,
                data=json.dumps(data, sort_keys=True),
                headers=HEADERS)
        except (requests.exceptions.ConnectionError, requests.exceptions.Timeout,
                requests.exceptions.TooManyRedirects, requests.exceptions.RequestException) as e:
            return return_error('Could not connect to Symantec MC: {}'.format(str(e)))

        if res.status_code < 200 or res.status_code > 300:
            status = res.status_code
            message = res.reason
            details = ''
            if res.status_code == 500:
                details = details + '\nA possible cause is that multiple requests were made simultaneously.'
            try:
                error_json = res.json()
                message = error_json.get('statusMessage')
                details = error_json.get('message')
            except Exception:
                pass
            return_error('Error in API call to Symantec MC, status code: {}, reason: {}, details: {}'
                         .format(status, message, details))

        try:
            return res.json()
        except Exception:
            if res.status_code == 204:
                return res
            return_error('Failed parsing the response from Symantec MC API: {}'.format(res.content))


    def verify_policy_content(content_type, ips, categories, urls):
        if ((content_type == IP_LIST_TYPE and not ips)
                or (content_type == URL_LIST_TYPE and not urls)
                or (content_type == CATEGORY_LIST_TYPE and not categories)):
            return_error('Incorrect content provided for the type {}'.format(content_type))
        if ((content_type == IP_LIST_TYPE and (urls or categories))
                or (content_type == URL_LIST_TYPE and (ips or categories))
                or (content_type == CATEGORY_LIST_TYPE and (ips or urls))):
            return_error('More than one content type was provided for the type {}'.format(content_type))


    def get_policy_uuid(uuid, name):
        if not uuid:
            if not name:
                return_error('Either a policy UUID or name must be provided')
            name_query = 'EQ ' + name
            policy = list_policies_request(name=name_query)
            if not policy or len(policy) == 0:
                return_error('Policy not found')
            if len(policy) > 1:
                return_error('Found more than one policy for the provided name')
            uuid = policy[0].get('uuid')
            if not uuid:
                return_error('Policy not found')

        return uuid


    ''' FUNCTIONS '''


    def test_module():
        """
        Performs basic get request to get system info
        """
        http_request('GET', 'system/info')
        demisto.results('ok')


    def list_devices_command():
        """
        List devices in Symantec MC using provided query filters
        """

        contents = []
        context = {}
        build = demisto.args().get('build')
        description = demisto.args().get('description')
        model = demisto.args().get('model')
        name = demisto.args().get('name')
        os_version = demisto.args().get('os_version')
        platform = demisto.args().get('platform')
        device_type = demisto.args().get('type')
        limit = int(demisto.args().get('limit', 10))

        devices = list_devices_request(build, description, model, name, os_version, platform, device_type)

        if devices:
            if limit:
                devices = devices[:limit]

            for device in devices:
                contents.append({
                    'UUID': device.get('uuid'),
                    'Name': device.get('name'),
                    'LastChanged': device.get('lastChanged'),
                    'Host': device.get('host'),
                    'Type': device.get('type')
                })
            headers = ['UUID', 'Name', 'LastChanged', 'Host', 'Type']
            human_readable = tableToMarkdown('Symantec Management Center Devices', contents,
                                             removeNull=True, headers=headers, headerTransform=pascalToSpace)
            context['SymantecMC.Device(val.UUID && val.UUID === obj.UUID)'] = createContext(contents, removeNull=True)
        else:
            human_readable = 'No devices found'

        return_outputs(human_readable, context, devices)


    def list_devices_request(build, description, model, name, os_version, platform, device_type):
        """
        Get devices from Symantec MC
        :param build: Device build number query
        :param description: Device description query
        :param model: Device model query
        :param name: Device name query
        :param os_version: Device OS version query
        :param platform: Device platform query
        :param device_type: Device type
        :return: List of Symantec MC devices
        """

        path = 'devices'
        params = {}

        if build:
            params['build'] = build
        if description:
            params['description'] = description
        if model:
            params['model'] = model
        if name:
            params['name'] = name
        if os_version:
            params['osVersion'] = os_version
        if platform:
            params['platform'] = platform
        if device_type:
            params['type'] = device_type

        response = http_request('GET', path, params)
        return response


    def get_device_command():
        """
        Command to get information for a specified device
        :return: An entry with the device data
        """
        uuid = demisto.args()['uuid']
        content: dict = {}
        context: dict = {}

        device = get_device_request(uuid)
        if device:
            content = {
                'UUID': device.get('uuid'),
                'Name': device.get('name'),
                'LastChanged': device.get('lastChanged'),
                'LastChangedBy': device.get('lastChangedBy'),
                'Description': device.get('description'),
                'Model': device.get('model'),
                'Platform': device.get('platform'),
                'Type': device.get('type'),
                'OSVersion': device.get('osVersion'),
                'Build': device.get('build'),
                'SerialNumber': device.get('serialNumber'),
                'Host': device.get('host'),
                'ManagementStatus': device.get('managementStatus'),
                'DeploymentStatus': device.get('deploymentStatus')
            }

            context['SymantecMC.Device(val.UUID && val.UUID === obj.UUID)'] = createContext(content, removeNull=True)

        headers = ['UUID', 'Name', 'LastChanged', 'LastChangedBy', 'Description',
                   'Model', 'Platform', 'Host', 'Type', 'OSVersion', 'Build', 'SerialNumber',
                   'ManagementStatus', 'DeploymentStatus']

        return_outputs(tableToMarkdown('Symantec Management Center Device', content,
                                       removeNull=True, headers=headers, headerTransform=pascalToSpace), context, device)


    def get_device_request(uuid):
        """
        Return data for a specified device
        :param uuid: The device UUID
        :return: The device data
        """
        path = 'devices/' + uuid

        response = http_request('GET', path)

        return response


    def get_device_health_command():
        """
            Command to get health information for a specified device
            :return: An entry with the device data and health
            """
        uuid = demisto.args()['uuid']
        health_content = []
        human_readable = ''
        context = {}

        device_health = get_device_health_request(uuid)
        if device_health:
            device_content = {
                'UUID': device_health.get('uuid'),
                'Name': device_health.get('name')
            }

            if device_health.get('health'):
                if not isinstance(device_health['health'], list):
                    device_health['health'] = [device_health['health']]
                for health in device_health['health']:
                    health_content.append({
                        'Category': health.get('category'),
                        'Name': health.get('name'),
                        'State': health.get('state'),
                        'Message': health.get('message'),
                        'Status': health.get('status')
                    })

            device_headers = ['UUID', 'Name']
            content = device_content
            human_readable = tableToMarkdown('Symantec Management Center Device', device_content,
                                             removeNull=True, headers=device_headers, headerTransform=pascalToSpace)
            if health_content:
                health_headers = ['Category', 'Name', 'State', 'Message', 'Status']
                human_readable += tableToMarkdown('Device Health', health_content,
                                                  removeNull=True, headers=health_headers, headerTransform=pascalToSpace)
                content['Health'] = health_content
            else:
                human_readable += '\n\nNo health details found for this device\n'

            context['SymantecMC.Device(val.UUID && val.UUID === obj.UUID)'] = createContext(content, removeNull=True)

        return_outputs(human_readable, context, device_health)


    def get_device_health_request(uuid):
        """
        Return health for a specified device
        :param uuid: The device UUID
        :return: The device health data
        """
        path = 'devices/' + uuid + '/health'

        response = http_request('GET', path)

        return response


    def get_device_license_command():
        """
        Command to get license information for a specified device
        :return: An entry with the device data and license information
        """
        uuid = demisto.args()['uuid']
        license_content = []
        human_readable = ''
        context = {}

        device_license = get_device_license_request(uuid)
        if device_license:

            if not isinstance(device_license['components'], list):
                device_license['components'] = [device_license['components']]

            device_content = {
                'UUID': device_license.get('uuid'),
                'Name': device_license.get('name'),
                'Type': device_license.get('deviceType'),
                'LicenseStatus': device_license.get('licenseStatus')
            }

            for component in device_license['components']:
                license_content.append({
                    'Name': component.get('componentName'),
                    'ActivationDate': component.get('activationDate'),
                    'ExpirationDate': component.get('expirationDate'),
                    'Validity': component.get('validity')
                })

            device_headers = ['UUID', 'Name', 'Type', 'LicenseStatus']
            content = device_content
            human_readable = tableToMarkdown('Symantec Management Center Device', device_content,
                                             removeNull=True, headers=device_headers, headerTransform=pascalToSpace)
            if license_content:
                license_headers = ['Name', 'ActivationDate', 'ExpirationDate', 'Validity']
                human_readable += tableToMarkdown('License Components', license_content,
                                                  removeNull=True, headers=license_headers, headerTransform=pascalToSpace)
                content['LicenseComponent'] = license_content

            context['SymantecMC.Device(val.UUID && val.UUID === obj.UUID)'] = createContext(content, removeNull=True)

        return_outputs(human_readable, context, device_license)


    def get_device_license_request(uuid):
        """
        Return the license for a specified device
        :param uuid: The device UUID
        :return: The device license data
        """
        path = 'devices/' + uuid + '/license'

        response = http_request('GET', path)

        return response


    def get_device_status_command():
        """
        Command to get the status for a specified device
        :return: An entry with the device status data
        """
        uuid = demisto.args()['uuid']
        content: dict = {}
        context: dict = {}

        device = get_device_status_request(uuid)
        if device:
            content = {
                'UUID': device.get('uuid'),
                'Name': device.get('name'),
                'CheckDate': device.get('checkDate'),
                'StartDate': device.get('startDate'),
                'MonitorState': device.get('monitorState'),
                'Warnings': len(device.get('warnings', [])),
                'Errors': len(device.get('errors', []))
            }

            context['SymantecMC.Device(val.UUID && val.UUID === obj.UUID)'] = createContext(content, removeNull=True)

        headers = ['UUID', 'Name', 'CheckDate', 'StartDate', 'MonitorState', 'Warnings', 'Errors']

        return_outputs(tableToMarkdown('Symantec Management Center Device Status', content,
                                       removeNull=True, headers=headers, headerTransform=pascalToSpace), context, device)


    def get_device_status_request(uuid):
        """
        Return data for a specified device status
        :param uuid: The device UUID
        :return: The device status data
        """
        path = 'devices/' + uuid + '/status'

        response = http_request('GET', path)

        return response


    def list_policies_command():
        """
        List policies in Symantec MC using provided query filters
        """

        contents = []
        context = {}
        content_type = demisto.args().get('content_type')
        description = demisto.args().get('description')
        name = demisto.args().get('name')
        reference_id = demisto.args().get('reference_id')
        shared = demisto.args().get('shared')
        tenant = demisto.args().get('tenant')
        limit = int(demisto.args().get('limit', 10))

        policies = list_policies_request(content_type, description, name, reference_id, shared, tenant)

        if policies:
            if limit:
                policies = policies[:limit]

            for policy in policies:
                contents.append({
                    'UUID': policy.get('uuid'),
                    'Name': policy.get('name'),
                    'ContentType': policy.get('contentType'),
                    'Author': policy.get('author'),
                    'Shared': policy.get('shared'),
                    'ReferenceID': policy.get('referenceId'),
                    'Tenant': policy.get('tenant'),
                    'ReplaceVariables': policy.get('replaceVariables')
                })
            headers = ['UUID', 'Name', 'ContentType', 'Author', 'Shared', 'ReferenceID', 'Tenant', 'ReplaceVariables']
            human_readable = tableToMarkdown('Symantec Management Center Policies', contents,
                                             removeNull=True, headers=headers, headerTransform=pascalToSpace)
            context['SymantecMC.Policy(val.UUID && val.UUID === obj.UUID)'] = createContext(contents, removeNull=True)
        else:
            human_readable = 'No policies found'

        return_outputs(human_readable, context, policies)


    def list_policies_request(content_type=None, description=None, name=None, reference_id=None, shared=None, tenant=None):
        """
        Get policies in Symantec MC
        :param content_type: Policy content type query
        :param description: Policy description query
        :param name: Policy name query
        :param reference_id: Policy reference ID query
        :param shared: Policy shared query
        :param tenant: Policy tenant query
        :return: List of policies in Symantec MC
        """
        path = 'policies'
        params = {}

        if content_type:
            params['contentType'] = content_type
        if description:
            params['description'] = description
        if name:
            params['name'] = name
        if reference_id:
            params['referenceId'] = reference_id
        if shared:
            params['shared'] = shared
        if tenant:
            params['tenant'] = tenant

        response = http_request('GET', path, params)
        return response


    def get_policy_command():
        """
        Command to get information for a specified policy including it's contents
        :return: An entry with the policy data
        """
        uuid = demisto.args().get('uuid')
        name = demisto.args().get('name')
        policy_content_data: dict = {}
        revision_content: dict = {}
        policy_content_content = []
        content_title = ''
        human_readable = ''
        content_headers: list = []
        content_key = ''
        context: dict = {}

        if not name and not uuid:
            return_error('Either a UUID or a name must be provided')

        uuid = get_policy_uuid(uuid, name)

        policy = get_policy_request(uuid)
        if policy:
            policy_content = {
                'UUID': policy.get('uuid'),
                'Name': policy.get('name'),
                'Description': policy.get('description'),
                'ContentType': policy.get('contentType'),
                'ReferenceID': policy.get('referenceId')
            }
            policy_content_data = get_policy_content_request(uuid)

            if policy_content_data and policy_content_data.get('revisionInfo'):
                policy_content['SchemaVersion'] = policy_content_data.get('schemaVersion')
                revision_content = {
                    'Number': policy_content_data['revisionInfo'].get('revisionNumber'),
                    'Description': policy_content_data['revisionInfo'].get('revisionDescription'),
                    'Author': policy_content_data['revisionInfo'].get('author'),
                    'Date': policy_content_data['revisionInfo'].get('revisionDate')
                }

            if policy.get('contentType') == URL_LIST_TYPE:
                content_title = 'URL List'
                content_headers = ['Address', 'Description', 'Enabled']
                content_key = 'URL'
                urls = policy_content_data.get('content', {}).get('urls', [])
                for url in urls:
                    policy_content_content.append({
                        'Address': url.get('url'),
                        'Description': url.get('description'),
                        'Enabled': url.get('enabled')
                    })
            elif policy.get('contentType') == IP_LIST_TYPE:
                content_title = 'IP List'
                content_headers = ['Address', 'Description', 'Enabled']
                content_key = 'IP'
                ips = policy_content_data.get('content', {}).get('ipAddresses', [])
                for ip in ips:
                    policy_content_content.append({
                        'Address': ip.get('ipAddress'),
                        'Description': ip.get('description'),
                        'Enabled': ip.get('enabled')
                    })
            elif policy.get('contentType') == CATEGORY_LIST_TYPE:
                content_title = 'Category List'
                content_headers = ['Name']
                content_key = 'Category'
                categories = policy_content_data.get('content', {}).get('categories', [])
                for category in categories:
                    policy_content_content.append({
                        'Name': category.get('categoryName')
                    })

            policy_headers = ['UUID', 'Name', 'SchemaVersion', 'ReferenceID', 'Description', 'ContentType']
            human_readable = tableToMarkdown('Symantec Management Center Policy', policy_content,
                                             removeNull=True, headers=policy_headers, headerTransform=pascalToSpace)
            content = policy_content
            if revision_content:
                revision_headers = ['Number', 'Description', 'Author', 'Date']
                content['RevisionInfo'] = revision_content
                human_readable += tableToMarkdown('Revision Information', revision_content,
                                                  removeNull=True, headers=revision_headers, headerTransform=pascalToSpace)

            if policy_content_content:
                content[content_key] = policy_content_content
                human_readable += tableToMarkdown(content_title, policy_content_content,
                                                  removeNull=True, headers=content_headers, headerTransform=pascalToSpace)

            context['SymantecMC.Policy(val.UUID && val.UUID === obj.UUID)'] = createContext(content, removeNull=True)

        policy.update(policy_content_data)
        return_outputs(human_readable, context, policy)


    def get_policy_request(uuid):
        """
        Return data for a specified policy
        :param uuid: The policy UUID
        :return: The policy data
        """
        path = 'policies/' + uuid

        response = http_request('GET', path)

        return response


    def get_policy_content_request(uuid):
        """
        Return content data for a specified policy
        :param uuid: The policy UUID
        :return: The policy content data
        """
        path = 'policies/' + uuid + '/content'

        response = http_request('GET', path)

        return response


    def create_policy_command():
        """
            Command to create a new policy in Symantec MC
            :return: An entry with the new policy data
        """
        name = demisto.args()['name']
        content_type = demisto.args()['content_type']
        description = demisto.args().get('description')
        reference_id = demisto.args().get('reference_id')
        tenant = demisto.args().get('tenant')
        shared = demisto.args().get('shared')
        replace_variables = demisto.args().get('replace_variables')

        content: dict = {}
        context: dict = {}

        policy = create_policy_request(name, content_type, description, reference_id, tenant, shared, replace_variables)
        if policy:
            content = {
                'UUID': policy.get('uuid'),
                'Name': policy.get('name'),
                'ContentType': policy.get('contentType'),
                'Author': policy.get('author')
            }

            context['SymantecMC.Policy(val.UUID && val.UUID === obj.UUID)'] = createContext(content, removeNull=True)

        headers = ['UUID', 'Name', 'ContentType', 'Author']

        return_outputs(tableToMarkdown('Policy created successfully', content,
                                       removeNull=True, headers=headers, headerTransform=pascalToSpace), context, policy)


    def create_policy_request(name, content_type, description, reference_id, tenant, shared, replace_variables):
        """
        Creates a policy in Symantec MC using the provided arguments
        :param name: Policy name
        :param content_type: Policy content type
        :param description: Policy description
        :param reference_id: Policy reference ID
        :param tenant: Policy tenant
        :param shared: Policy shared
        :param replace_variables: Policy replace variables
        :return: The created policy data
        """
        path = 'policies'

        body = {
            'name': name,
            'contentType': content_type
        }

        if description:
            body['description'] = description
        if reference_id:
            body['referenceId'] = reference_id
        if tenant:
            body['tenant'] = tenant
        if shared:
            body['shared'] = shared
        if replace_variables:
            body['replaceVariables'] = replace_variables

        response = http_request('POST', path, data=body)
        return response


    def update_policy_command():
        """
            Command to update an existing policy in Symantec MC
            :return: An entry with the policy data
        """
        uuid = demisto.args()['uuid']
        name = demisto.args().get('name')
        description = demisto.args().get('description')
        reference_id = demisto.args().get('reference_id')
        replace_variables = demisto.args().get('replace_variables')

        content: dict = {}
        context: dict = {}

        policy = update_policy_request(uuid, name, description, reference_id, replace_variables)
        if policy:
            content = {
                'UUID': policy.get('uuid'),
                'Name': policy.get('name'),
                'ContentType': policy.get('contentType'),
                'Author': policy.get('author')
            }

            context['SymantecMC.Policy(val.UUID && val.UUID === obj.UUID)'] = createContext(content, removeNull=True)

        headers = ['UUID', 'Name', 'ContentType', 'Author']

        return_outputs(tableToMarkdown('Policy updated successfully', content,
                                       removeNull=True, headers=headers, headerTransform=pascalToSpace), context, policy)


    def update_policy_request(uuid, name, description, reference_id, replace_variables):
        """
        Updates a policy in Symantec MC using the provided arguments
        :param uuid: Policy UUID
        :param name: New policy name
        :param description: New policy description
        :param reference_id: New policy reference ID
        :param replace_variables: New policy replace variables
        :return: The updated policy data
        """
        path = 'policies/' + uuid

        body = {}

        if name:
            body['name'] = name
        if description:
            body['description'] = description
        if reference_id:
            body['referenceId'] = reference_id
        if replace_variables:
            body['replaceVariables'] = replace_variables

        response = http_request('PUT', path, data=body)
        return response


    def delete_policy_command():
        """
            Command to delete an existing policy in Symantec MC
            :return: An entry indicating whether the deletion was successful
        """
        uuid = demisto.args()['uuid']
        force = demisto.args().get('force')

        delete_policy_request(uuid, force)
        return_outputs('Policy deleted successfully', {}, {})


    def delete_policy_request(uuid, force):
        """
        Deletes a policy in Symantec MC using the provided arguments
        :param uuid: Policy UUID
        :param force: Force policy delete
        :return: The deletion response
        """
        path = 'policies/' + uuid

        response = http_request('DELETE', path, data=force)
        return response


    def add_policy_content_command():
        """
            Command to add content to an existing policy in Symantec MC
            :return: An entry indicating whether the addition was successful
        """
        uuid = demisto.args().get('uuid')
        name = demisto.args().get('name')
        content_type = demisto.args()['content_type']
        change_description = demisto.args()['change_description']
        schema_version = demisto.args().get('schema_version')
        ips = argToList(demisto.args().get('ip', []))
        urls = argToList(demisto.args().get('url', []))
        categories = argToList(demisto.args().get('category', []))
        enabled = demisto.args().get('enabled')
        description = demisto.args().get('description')

        verify_policy_content(content_type, ips, categories, urls)

        uuid = get_policy_uuid(uuid, name)

        if content_type == IP_LIST_TYPE:
            add_policy_content_request(uuid, content_type, change_description, schema_version,
                                       ips=ips, enabled=enabled, description=description)
        elif content_type == URL_LIST_TYPE:
            add_policy_content_request(uuid, content_type, change_description, schema_version,
                                       urls=urls, enabled=enabled, description=description)
        elif content_type == CATEGORY_LIST_TYPE:
            add_policy_content_request(uuid, content_type, change_description, schema_version,
                                       categories=categories)

        return_outputs('Successfully added content to the policy', {}, {})


    def add_policy_content_request(uuid, content_type, change_description, schema_version,
                                   ips=None, urls=None, categories=None, enabled=None, description=''):
        """
        Add content to a specified policy using the provided arguments
        :param uuid: Policy UUID
        :param content_type: Policy content type
        :param change_description: Policy update change description
        :param schema_version: Policy schema version
        :param ips: IPs to add to the content
        :param urls: URLs to add to the content
        :param categories: Category names to add to the content
        :param enabled:  Policy content enabled
        :param description: Policy content description
        :return: Content update response
        """
        path = 'policies/' + uuid + '/content'

        body = {
            'contentType': content_type,
            'changeDescription': change_description
        }

        if schema_version:
            body['schemaVersion'] = schema_version

        content = get_policy_content_request(uuid)
        if not content or 'content' not in content:
            return_error('Could not update policy content - failed retrieving the current content')

        if ips:
            if 'ipAddresses' not in content['content']:
                content['content']['ipAddresses'] = []
            content['content']['ipAddresses'] += [{
                'ipAddress': ip,
                'description': description,
                'enabled': bool(strtobool(enabled))
            } for ip in ips]
        elif urls:
            if 'urls' not in content['content']:
                content['content']['urls'] = []
            content['content']['urls'] += [{
                'url': url,
                'description': description,
                'enabled': bool(strtobool(enabled))
            } for url in urls]
        elif categories:
            if 'categories' not in content['content']:
                content['content']['categories'] = []
            content['content']['categories'] += [{
                'categoryName': category,
            } for category in categories]

        body['content'] = content['content']
        response = http_request('POST', path, data=body)

        return response


    def delete_policy_content_command():
        """
            Command to delete content from an existing policy in Symantec MC
            :return: An entry indicating whether the deletion was successful
        """
        uuid = demisto.args().get('uuid')
        name = demisto.args().get('name')
        content_type = demisto.args()['content_type']
        change_description = demisto.args()['change_description']
        schema_version = demisto.args().get('schema_version')
        ips = argToList(demisto.args().get('ip', []))
        urls = argToList(demisto.args().get('url', []))
        categories = argToList(demisto.args().get('category', []))

        verify_policy_content(content_type, ips, categories, urls)

        uuid = get_policy_uuid(uuid, name)

        if content_type == IP_LIST_TYPE:
            delete_policy_content_request(uuid, content_type, change_description, schema_version, ips=ips)
        elif content_type == URL_LIST_TYPE:
            delete_policy_content_request(uuid, content_type, change_description, schema_version, urls=urls)
        elif content_type == CATEGORY_LIST_TYPE:
            delete_policy_content_request(uuid, content_type, change_description, schema_version, categories=categories)

        return_outputs('Successfully deleted content from the policy', {}, {})


    def delete_policy_content_request(uuid, content_type, change_description, schema_version,
                                      ips=None, urls=None, categories=None):
        """
        Add content to a specified policy using the provided arguments
        :param uuid: Policy UUID
        :param content_type: Policy content type
        :param change_description: Policy update change description
        :param schema_version: Policy schema version
        :param ips: IPs to delete from the content
        :param urls: URLs to delete from the content
        :param categories: Category names to delete from the content
        :return: Content update response
        """
        path = 'policies/' + uuid + '/content'

        body = {
            'contentType': content_type,
            'changeDescription': change_description
        }

        if schema_version:
            body['schemaVersion'] = schema_version

        content = get_policy_content_request(uuid)
        if not content or 'content' not in content:
            return_error('Could not update policy content - failed retrieving the current content')

        if ips:
            if 'ipAddresses' in content['content']:
                ips_to_keep = [ip for ip in content['content']['ipAddresses'] if ip['ipAddress'] not in ips]
                content['content']['ipAddresses'] = ips_to_keep
        elif urls:
            if 'urls' in content['content']:
                urls_to_keep = [url for url in content['content']['urls'] if url['url'] not in urls]
                content['content']['urls'] = urls_to_keep
        elif categories:
            if 'categories' in content['content']:
                categories_to_keep = [category for category in content['content']['categories']
                                      if category['categoryName'] not in categories]
                content['content']['categories'] = categories_to_keep

        body['content'] = content['content']
        response = http_request('POST', path, data=body)

        return response


    def list_tenants_command():
        """
        List tenants in Symantec MC
        """

        contents = []
        context = {}
        limit = int(demisto.args().get('limit', 10))

        tenants = list_tenants_request()

        if tenants:
            if limit:
                tenants = tenants[:limit]

            for tenant in tenants:
                contents.append({
                    'UUID': tenant.get('uuid'),
                    'Name': tenant.get('name'),
                    'ExternalID': tenant.get('externalId'),
                    'Description': tenant.get('description'),
                    'System': tenant.get('system')
                })
            headers = ['UUID', 'Name', 'ExternalID', 'Description', 'System']
            human_readable = tableToMarkdown('Symantec Management Center Tenants', contents,
                                             removeNull=True, headers=headers, headerTransform=pascalToSpace)
            context['SymantecMC.Tenant(val.UUID && val.UUID === obj.UUID)'] = createContext(contents, removeNull=True)
        else:
            human_readable = 'No tenants found'

        return_outputs(human_readable, context, tenants)


    def list_tenants_request():
        """
        Get devices from Symantec MC
        :return: List of Symantec MC tenants
        """

        path = 'tenants'
        params: dict = {}

        response = http_request('GET', path, params)
        return response


    ''' COMMANDS '''
    LOG('Command being called is ' + demisto.command())
    handle_proxy()

    COMMAND_DICTIONARY = {
        'test-module': test_module,
        'symantec-mc-list-devices': list_devices_command,
        'symantec-mc-get-device': get_device_command,
        'symantec-mc-get-device-health': get_device_health_command,
        'symantec-mc-get-device-license': get_device_license_command,
        'symantec-mc-get-device-status': get_device_status_command,
        'symantec-mc-list-policies': list_policies_command,
        'symantec-mc-get-policy': get_policy_command,
        'symantec-mc-create-policy': create_policy_command,
        'symantec-mc-update-policy': update_policy_command,
        'symantec-mc-delete-policy': delete_policy_command,
        'symantec-mc-add-policy-content': add_policy_content_command,
        'symantec-mc-delete-policy-content': delete_policy_content_command,
        'symantec-mc-list-tenants': list_tenants_command
    }

    try:
        command_func = COMMAND_DICTIONARY[demisto.command()]
        command_func()
    except Exception as e:
        LOG(str(e))
        LOG.print_log()
        return_error(str(e))
  subtype: python3
  type: python
system: true
